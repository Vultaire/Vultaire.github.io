import{a as append,f as from_html,c as comment,t as text}from"../chunks/CsM7k7bz.js";import{c as create_text,b as block,h as hydrating,a as set_hydrate_node,e as get_first_child,K as hydrate_next,x as get,L as read_hydration_instruction,N as HYDRATION_START_ELSE,O as skip_nodes,s as set_hydrating,d as hydrate_node,C as COMMENT_NODE,aD as HYDRATION_END,ap as internal_set,f as current_batch,aL as EFFECT_OFFSCREEN,j as branch,aM as each_key_duplicate,k as should_defer_append,Y as derived_safe_equal,aN as is_array,aB as array_from,aO as EACH_ITEM_REACTIVE,aP as EACH_ITEM_IMMUTABLE,aH as mutable_source,ad as source,aQ as EACH_INDEX_REACTIVE,r as resume_effect,p as pause_effect,aR as INERT,aS as BRANCH_EFFECT,aA as clear_text_content,i as destroy_effect,g as get_next_sibling,aT as EACH_IS_CONTROLLED,ac as queue_micro_task,aU as EACH_IS_ANIMATED,aV as listen_to_event_and_reset_event,aF as effect,aW as previous_batch,aX as select_multiple_invalid_value,aY as is,aZ as teardown,a_ as add_form_reset_listener,a$ as LOADING_ATTR_SYMBOL,b0 as NAMESPACE_HTML,b1 as IS_XHTML,o as untrack,aa as render_effect,aI as tick,B as push,aJ as state,R as proxy,F as pop,G as child,J as sibling,I as reset,S as set,aK as user_derived,q as first_child,D as template_effect,u as user_effect,aq as next,b2 as deferred_template_effect,b3 as $document}from"../chunks/C3XYL8Aj.js";import{d as delegate,a as delegated,s as set_text}from"../chunks/CazRKWZ2.js";import{p as prop,i as if_block}from"../chunks/BM8u6bfv.js";import{h as head}from"../chunks/faUMISoI.js";import{o as onMount}from"../chunks/Bir3OjzT.js";import{p as page}from"../chunks/CmUA54g1.js";import{g as goto}from"../chunks/CN3uwCrj.js";function index(e,t){return t}function pause_effects(e,t,a){for(var _=[],c=t.length,s,f=t.length,k=0;k<c;k++){let p=t[k];pause_effect(p,()=>{if(s){if(s.pending.delete(p),s.done.add(p),s.pending.size===0){var g=e.outrogroups;destroy_effects(array_from(s.done)),g.delete(s),g.size===0&&(e.outrogroups=null)}}else f-=1},!1)}if(f===0){var d=_.length===0&&a!==null;if(d){var v=a,u=v.parentNode;clear_text_content(u),u.append(v),e.items.clear()}destroy_effects(t,!d)}else s={pending:new Set(t),done:new Set},(e.outrogroups??=new Set).add(s)}function destroy_effects(e,t=!0){for(var a=0;a<e.length;a++)destroy_effect(e[a],t)}var offscreen_anchor;function each(e,t,a,_,c,s=null){var f=e,k=new Map,d=(t&EACH_IS_CONTROLLED)!==0;if(d){var v=e;f=hydrating?set_hydrate_node(get_first_child(v)):v.appendChild(create_text())}hydrating&&hydrate_next();var u=null,p=derived_safe_equal(()=>{var n=a();return is_array(n)?n:n==null?[]:array_from(n)}),g,x=!0;function C(){r.fallback=u,reconcile(r,g,f,t,_),u!==null&&(g.length===0?(u.f&EFFECT_OFFSCREEN)===0?resume_effect(u):(u.f^=EFFECT_OFFSCREEN,move(u,null,f)):pause_effect(u,()=>{u=null}))}var V=block(()=>{g=get(p);var n=g.length;let I=!1;if(hydrating){var U=read_hydration_instruction(f)===HYDRATION_START_ELSE;U!==(n===0)&&(f=skip_nodes(),set_hydrate_node(f),set_hydrating(!1),I=!0)}for(var P=new Set,F=current_batch,T=should_defer_append(),w=0;w<n;w+=1){hydrating&&hydrate_node.nodeType===COMMENT_NODE&&hydrate_node.data===HYDRATION_END&&(f=hydrate_node,I=!0,set_hydrating(!1));var j=g[w],q=_(j,w),A=x?null:k.get(q);A?(A.v&&internal_set(A.v,j),A.i&&internal_set(A.i,w),T&&F.unskip_effect(A.e)):(A=create_item(k,x?f:offscreen_anchor??=create_text(),j,q,w,c,t,a),x||(A.e.f|=EFFECT_OFFSCREEN),k.set(q,A)),P.add(q)}if(n===0&&s&&!u&&(x?u=branch(()=>s(f)):(u=branch(()=>s(offscreen_anchor??=create_text())),u.f|=EFFECT_OFFSCREEN)),n>P.size&&each_key_duplicate(),hydrating&&n>0&&set_hydrate_node(skip_nodes()),!x)if(T){for(const[L,H]of k)P.has(L)||F.skip_effect(H.e);F.oncommit(C),F.ondiscard(()=>{})}else C();I&&set_hydrating(!0),get(p)}),r={effect:V,items:k,outrogroups:null,fallback:u};x=!1,hydrating&&(f=hydrate_node)}function skip_to_branch(e){for(;e!==null&&(e.f&BRANCH_EFFECT)===0;)e=e.next;return e}function reconcile(e,t,a,_,c){var s=(_&EACH_IS_ANIMATED)!==0,f=t.length,k=e.items,d=skip_to_branch(e.effect.first),v,u=null,p,g=[],x=[],C,V,r,n;if(s)for(n=0;n<f;n+=1)C=t[n],V=c(C,n),r=k.get(V).e,(r.f&EFFECT_OFFSCREEN)===0&&(r.nodes?.a?.measure(),(p??=new Set).add(r));for(n=0;n<f;n+=1){if(C=t[n],V=c(C,n),r=k.get(V).e,e.outrogroups!==null)for(const A of e.outrogroups)A.pending.delete(r),A.done.delete(r);if((r.f&EFFECT_OFFSCREEN)!==0)if(r.f^=EFFECT_OFFSCREEN,r===d)move(r,null,a);else{var I=u?u.next:d;r===e.effect.last&&(e.effect.last=r.prev),r.prev&&(r.prev.next=r.next),r.next&&(r.next.prev=r.prev),link(e,u,r),link(e,r,I),move(r,I,a),u=r,g=[],x=[],d=skip_to_branch(u.next);continue}if((r.f&INERT)!==0&&(resume_effect(r),s&&(r.nodes?.a?.unfix(),(p??=new Set).delete(r))),r!==d){if(v!==void 0&&v.has(r)){if(g.length<x.length){var U=x[0],P;u=U.prev;var F=g[0],T=g[g.length-1];for(P=0;P<g.length;P+=1)move(g[P],U,a);for(P=0;P<x.length;P+=1)v.delete(x[P]);link(e,F.prev,T.next),link(e,u,F),link(e,T,U),d=U,u=T,n-=1,g=[],x=[]}else v.delete(r),move(r,d,a),link(e,r.prev,r.next),link(e,r,u===null?e.effect.first:u.next),link(e,u,r),u=r;continue}for(g=[],x=[];d!==null&&d!==r;)(v??=new Set).add(d),x.push(d),d=skip_to_branch(d.next);if(d===null)continue}(r.f&EFFECT_OFFSCREEN)===0&&g.push(r),u=r,d=skip_to_branch(r.next)}if(e.outrogroups!==null){for(const A of e.outrogroups)A.pending.size===0&&(destroy_effects(array_from(A.done)),e.outrogroups?.delete(A));e.outrogroups.size===0&&(e.outrogroups=null)}if(d!==null||v!==void 0){var w=[];if(v!==void 0)for(r of v)(r.f&INERT)===0&&w.push(r);for(;d!==null;)(d.f&INERT)===0&&d!==e.fallback&&w.push(d),d=skip_to_branch(d.next);var j=w.length;if(j>0){var q=(_&EACH_IS_CONTROLLED)!==0&&f===0?a:null;if(s){for(n=0;n<j;n+=1)w[n].nodes?.a?.measure();for(n=0;n<j;n+=1)w[n].nodes?.a?.fix()}pause_effects(e,w,q)}}s&&queue_micro_task(()=>{if(p!==void 0)for(r of p)r.nodes?.a?.apply()})}function create_item(e,t,a,_,c,s,f,k){var d=(f&EACH_ITEM_REACTIVE)!==0?(f&EACH_ITEM_IMMUTABLE)===0?mutable_source(a,!1,!1):source(a):null,v=(f&EACH_INDEX_REACTIVE)!==0?source(c):null;return{v:d,i:v,e:branch(()=>(s(t,d??a,v??c,k),()=>{e.delete(_)}))}}function move(e,t,a){if(e.nodes)for(var _=e.nodes.start,c=e.nodes.end,s=t&&(t.f&EFFECT_OFFSCREEN)===0?t.nodes.start:a;_!==null;){var f=get_next_sibling(_);if(s.before(_),_===c)return;_=f}}function link(e,t,a){t===null?e.effect.first=a:t.next=a,a===null?e.effect.last=t:a.prev=t}function select_option(e,t,a=!1){if(e.multiple){if(t==null)return;if(!is_array(t))return select_multiple_invalid_value();for(var _ of e.options)_.selected=t.includes(get_option_value(_));return}for(_ of e.options){var c=get_option_value(_);if(is(c,t)){_.selected=!0;return}}(!a||t!==void 0)&&(e.selectedIndex=-1)}function init_select(e){var t=new MutationObserver(()=>{select_option(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),teardown(()=>{t.disconnect()})}function bind_select_value(e,t,a=t){var _=new WeakSet,c=!0;listen_to_event_and_reset_event(e,"change",s=>{var f=s?"[selected]":":checked",k;if(e.multiple)k=[].map.call(e.querySelectorAll(f),get_option_value);else{var d=e.querySelector(f)??e.querySelector("option:not([disabled])");k=d&&get_option_value(d)}a(k),current_batch!==null&&_.add(current_batch)}),effect(()=>{var s=t();if(e===document.activeElement){var f=previous_batch??current_batch;if(_.has(f))return}if(select_option(e,s,c),c&&s===void 0){var k=e.querySelector(":checked");k!==null&&(s=get_option_value(k),a(s))}e.__value=s,c=!1}),init_select(e)}function get_option_value(e){return"__value"in e?e.__value:e.value}const IS_CUSTOM_ELEMENT=Symbol("is custom element"),IS_HTML=Symbol("is html"),LINK_TAG=IS_XHTML?"link":"LINK";function remove_input_defaults(e){if(hydrating){var t=!1,a=()=>{if(!t){if(t=!0,e.hasAttribute("value")){var _=e.value;set_attribute(e,"value",null),e.value=_}if(e.hasAttribute("checked")){var c=e.checked;set_attribute(e,"checked",null),e.checked=c}}};e.__on_r=a,queue_micro_task(a),add_form_reset_listener()}}function set_attribute(e,t,a,_){var c=get_attributes(e);hydrating&&(c[t]=e.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&e.nodeName===LINK_TAG)||c[t]!==(c[t]=a)&&(t==="loading"&&(e[LOADING_ATTR_SYMBOL]=a),e.removeAttribute(t))}function get_attributes(e){return e.__attributes??={[IS_CUSTOM_ELEMENT]:e.nodeName.includes("-"),[IS_HTML]:e.namespaceURI===NAMESPACE_HTML}}function bind_value(e,t,a=t){var _=new WeakSet;listen_to_event_and_reset_event(e,"input",async c=>{var s=c?e.defaultValue:e.value;if(s=is_numberlike_input(e)?to_number(s):s,a(s),current_batch!==null&&_.add(current_batch),await tick(),s!==(s=t())){var f=e.selectionStart,k=e.selectionEnd,d=e.value.length;if(e.value=s??"",k!==null){var v=e.value.length;f===k&&k===d&&v>d?(e.selectionStart=v,e.selectionEnd=v):(e.selectionStart=f,e.selectionEnd=Math.min(k,v))}}}),(hydrating&&e.defaultValue!==e.value||untrack(t)==null&&e.value)&&(a(is_numberlike_input(e)?to_number(e.value):e.value),current_batch!==null&&_.add(current_batch)),render_effect(()=>{var c=t();if(e===document.activeElement){var s=previous_batch??current_batch;if(_.has(s))return}is_numberlike_input(e)&&c===to_number(e.value)||e.type==="date"&&!c&&!e.value||c!==e.value&&(e.value=c??"")})}const pending=new Set;function bind_group(e,t,a,_,c=_){var s=a.getAttribute("type")==="checkbox",f=e;let k=!1;if(t!==null)for(var d of t)f=f[d]??=[];f.push(a),listen_to_event_and_reset_event(a,"change",()=>{var v=a.__value;s&&(v=get_binding_group_value(f,v,a.checked)),c(v)},()=>c(s?[]:null)),render_effect(()=>{var v=_();if(hydrating&&a.defaultChecked!==a.checked){k=!0;return}s?(v=v||[],a.checked=v.includes(a.__value)):a.checked=is(a.__value,v)}),teardown(()=>{var v=f.indexOf(a);v!==-1&&f.splice(v,1)}),pending.has(f)||(pending.add(f),queue_micro_task(()=>{f.sort((v,u)=>v.compareDocumentPosition(u)===4?-1:1),pending.delete(f)})),queue_micro_task(()=>{if(k){var v;if(s)v=get_binding_group_value(f,v,a.checked);else{var u=f.find(p=>p.checked);v=u?.__value}c(v)}})}function bind_checked(e,t,a=t){listen_to_event_and_reset_event(e,"change",_=>{var c=_?e.defaultChecked:e.checked;a(c)}),(hydrating&&e.defaultChecked!==e.checked||untrack(t)==null)&&a(e.checked),render_effect(()=>{var _=t();e.checked=!!_})}function get_binding_group_value(e,t,a){for(var _=new Set,c=0;c<e.length;c+=1)e[c].checked&&_.add(e[c].__value);return a||_.delete(t),Array.from(_)}function is_numberlike_input(e){var t=e.type;return t==="number"||t==="range"}function to_number(e){return e===""?null:+e}var root_9=from_html("<option> </option>"),root_14=from_html("<option> </option>"),root_5=from_html('<div><div><!> <select autocomplete="off"></select></div> <div><!> <select autocomplete="off"><!></select> <!> <input autocomplete="off" type="range" min="10" max="300"/> </div></div>'),root_17$2=from_html('<div><input id="kanji" type="checkbox" autocomplete="off"/><label for="kanji"><!></label></div>'),root$2=from_html('<div><!> <!> <div><input id="speak-by-part" type="checkbox" autocomplete="off"/><label for="speak-by-part"><!></label></div></div>');function VoiceSelector(e,t){push(t,!0);let a=prop(t,"selectedLanguage",15),_=prop(t,"kanji",15),c=prop(t,"speakByPart",7),s=state(proxy({})),f,k,d=state(void 0),v=100,u=state(proxy(v)),p=user_derived(()=>a()=="ja-JP");function g(){set(s,{},!0),window.speechSynthesis.getVoices().filter(S=>S.localService).forEach(S=>{["en-US","ja-JP"].indexOf(S.lang)>-1&&(get(s)[S.lang]??=[],get(s)[S.lang].push(S))}),U(),F()}function x(m){r()}function C(m){n()}function V(m){I()}function r(){a()!=f&&(f=a(),t.onLanguageChanged(a()),F())}function n(){get(d)!=k&&(k=get(d),t.onVoiceChanged(get(d)))}function I(){get(u)!=v&&(v=get(u),t.onRateChanged(get(u)))}function U(){if(!a()){let m=Object.keys(get(s)).sort()[0];P(m)}}function P(m){a(m),r()}function F(){if(a()&&Object.hasOwn(get(s),a())&&get(s)[a()].length>0){if(get(d)!==void 0){if(get(s)[a()].indexOf(get(d))!==-1)return}T(get(s)[a()][0])}}function T(m){set(d,m,!0),n()}function w(m){return new Intl.DisplayNames([navigator.language],{type:"language"}).of(m)||m}onMount(()=>(g(),window.speechSynthesis.addEventListener("voiceschanged",g),()=>{window.speechSynthesis.removeEventListener("voiceschanged",g)}));var j=root$2(),q=child(j);{var A=m=>{var S=comment(),z=first_child(S);{var G=R=>{var M=text("声をロード中...");append(R,M)},Q=R=>{var M=text("こえをロードちゅう...");append(R,M)},Z=R=>{var M=text("Loading voices...");append(R,M)};if_block(z,R=>{get(p)&&_()?R(G):get(p)?R(Q,1):R(Z,!1)})}append(m,S)},L=user_derived(()=>Object.keys(get(s)).length===0),H=m=>{var S=root_5(),z=child(S),G=child(z);{var Q=l=>{var h=text("言語：");append(l,h)},Z=l=>{var h=text("げんご：");append(l,h)},R=l=>{var h=text("Language:");append(l,h)};if_block(G,l=>{get(p)&&_()?l(Q):get(p)?l(Z,1):l(R,!1)})}var M=sibling(G,2);each(M,21,()=>Object.keys(get(s)).sort(),index,(l,h)=>{var O=root_9(),B=child(O,!0);reset(O);var D={};template_effect(b=>{set_text(B,b),D!==(D=get(h))&&(O.value=(O.__value=get(h))??"")},[()=>w(get(h))]),append(l,O)}),reset(M),reset(z);var K=sibling(z,2),de=child(K);{var ue=l=>{var h=text("声：");append(l,h)},pe=l=>{var h=text("こえ：");append(l,h)},ce=l=>{var h=text("Voice:");append(l,h)};if_block(de,l=>{get(p)&&_()?l(ue):get(p)?l(pe,1):l(ce,!1)})}var $=sibling(de,2),ge=child($);{var oe=l=>{var h=comment(),O=first_child(h);each(O,17,()=>get(s)[a()],index,(B,D)=>{var b=root_14(),y=child(b,!0);reset(b);var J={};template_effect(()=>{set_text(y,get(D).name),J!==(J=get(D))&&(b.value=(b.__value=get(D))??"")}),append(B,b)}),append(l,h)};if_block(ge,l=>{typeof a()=="string"&&l(oe)})}reset($);var le=sibling($,2);{var he=l=>{var h=text("スピード（パーセント）：");append(l,h)},me=l=>{var h=text("Speed (percentage):");append(l,h)};if_block(le,l=>{get(p)?l(he):l(me,!1)})}var re=sibling(le,2);remove_input_defaults(re);var o=sibling(re);reset(K),reset(S),template_effect(()=>set_text(o,` ${get(u)??""}%`)),delegated("change",M,x),bind_select_value(M,a),delegated("change",$,C),bind_select_value($,()=>get(d),l=>set(d,l)),delegated("change",re,V),bind_value(re,()=>get(u),l=>set(u,l)),append(m,S)};if_block(q,m=>{get(L)?m(A):m(H,!1)})}var ie=sibling(q,2);{var W=m=>{var S=root_17$2(),z=child(S);remove_input_defaults(z);var G=sibling(z),Q=child(G);{var Z=M=>{var K=text("漢字を使う");append(M,K)},R=M=>{var K=text("かんじをつかう");append(M,K)};if_block(Q,M=>{_()?M(Z):M(R,!1)})}reset(G),reset(S),bind_checked(z,_),append(m,S)};if_block(ie,m=>{get(p)&&m(W)})}var se=sibling(ie,2),X=child(se);remove_input_defaults(X);var ne=sibling(X),fe=child(ne);{var ve=m=>{var S=text("問題を部分で言う");append(m,S)},ae=m=>{var S=text("もんだいをぶぶんでいう");append(m,S)},_e=m=>{var S=text("Say part-by-part");append(m,S)};if_block(fe,m=>{get(p)&&_()?m(ve):get(p)?m(ae,1):m(_e,!1)})}reset(ne),reset(se),reset(j),delegated("change",X,function(...m){t.onSpeechModeChanged?.apply(this,m)}),bind_checked(X,c),append(e,j),pop()}delegate(["change"]);class ProblemState{#e;get problem(){return get(this.#e)}set problem(t){set(this.#e,t,!0)}#t;get showAnswer(){return get(this.#t)}set showAnswer(t){set(this.#t,t,!0)}constructor(t){this.#e=state(proxy(t)),this.#t=state(!1)}}var root_1=from_html('<input class="problem-simple svelte-1ew1gyx" type="text" autocomplete="off"/>'),root_4=from_html("<button><!></button>"),root_13$1=from_html("<button><!></button>"),root_17$1=from_html("答えを<!>",1),root_20=from_html("こたえを<!>",1),root_23=from_html("<!> answer",1),root_26$1=from_html('<span class="answer"> </span>'),root_2=from_html("<!> <button><!></button> <!>",1),root_27$1=from_html('<span class="debug"> </span>'),root$1=from_html("<div><!> <!></div>");function ProblemSimple($$anchor,$$props){push($$props,!0);const substitutions={"en-US":{"-":"minus","*":"multiplied by","/":"divided by"},"ja-JP":{"+":"たす","-":"ひく","*":"かける","/":"わる"}},validTokensRgx=/(\d+|[\+\-\*\/])/g,digitRgx=/^\d+$/;let problem=prop($$props,"problem",15),showAnswer=prop($$props,"showAnswer",15),lastProblemValue=null,ja=user_derived(()=>$$props.selectedLanguage=="ja-JP"),utteranceIndex=state(0),tokenSubstitutions=user_derived(()=>substitutions[$$props.selectedLanguage]||{}),evalTokens=user_derived(()=>{const e=getSanitizedTokens(),t=[],a=[];return e.forEach(_=>{t.push(_),_.match(digitRgx)&&(a.push(t.join(" ")),t.length=0)}),a}),speechTokens=user_derived(()=>get(evalTokens).map((e,t)=>{for(const a in get(tokenSubstitutions)){let _=get(tokenSubstitutions)[a];e=e.replace(a,_)}if(t===get(evalTokens).length-1){const a=get(ja)?" は":" is";e+=a}return e}));function onListenClicked(){if(!$$props.selectedVoice){console.error("onListenClicked: unexpected unset selected voice");return}let e=get(speechTokens).join(", ");speak(e)}function onListenIncrementalClicked(){if(!$$props.selectedVoice){console.error("onListenClicked: unexpected unset selected voice");return}speak(get(speechTokens)[get(utteranceIndex)]),set(utteranceIndex,(get(utteranceIndex)+1)%get(speechTokens).length)}function speak(e){if($$props.selectedVoice){const t=new SpeechSynthesisUtterance(e);t.lang=$$props.selectedLanguage??"en-US",t.rate=$$props.selectedRate/100,t.voice=$$props.selectedVoice,window.speechSynthesis.speak(t)}}function getSanitizedTokens(){return Array.from(problem().matchAll(validTokensRgx)).map(function(t){return t[1]})}function sanitizeProblem(){return getSanitizedTokens().join(" ")}function onProblemInnerChange(){lastProblemValue!=problem()&&(lastProblemValue=problem(),$$props.onProblemChange())}function onkeyup(e){console.log(typeof e),e.key=="Enter"&&$$props.onEnter()}function getProblemWithAnswer(){const sanitizedProblem=sanitizeProblem();let answer="0";try{get(evalTokens).length>0&&(answer=eval(get(evalTokens)[0]).toString());for(let i=1;i<get(evalTokens).length;i++)answer=eval([answer,get(evalTokens)[i]].join(" ")).toString()}catch(e){answer="<error>"}return`${sanitizedProblem} = ${answer}`}user_effect(()=>{problem(),set(utteranceIndex,0)}),onMount(()=>{lastProblemValue=problem()});var div=root$1(),node=child(div);{var consequent=e=>{var t=root_1();remove_input_defaults(t),delegated("input",t,onProblemInnerChange),delegated("keyup",t,onkeyup),bind_value(t,problem),append(e,t)},alternate_9=e=>{var t=root_2(),a=first_child(t);{var _=p=>{var g=comment(),x=first_child(g);{var C=r=>{var n=root_4(),I=child(n);{var U=F=>{var T=comment(),w=first_child(T);{var j=L=>{var H=text("聞き始める");append(L,H)},q=L=>{var H=text("ききはじめる");append(L,H)},A=L=>{var H=text("Start listening");append(L,H)};if_block(w,L=>{get(ja)&&$$props.kanji?L(j):get(ja)?L(q,1):L(A,!1)})}append(F,T)},P=F=>{var T=comment(),w=first_child(T);{var j=L=>{var H=text("もっと聞く");append(L,H)},q=L=>{var H=text("もっときく");append(L,H)},A=L=>{var H=text("Continue listening");append(L,H)};if_block(w,L=>{get(ja)&&$$props.kanji?L(j):get(ja)?L(q,1):L(A,!1)})}append(F,T)};if_block(I,F=>{get(utteranceIndex)==0?F(U):F(P,!1)})}reset(n),delegated("click",n,onListenIncrementalClicked),append(r,n)},V=r=>{var n=root_13$1(),I=child(n);{var U=T=>{var w=text("聞く");append(T,w)},P=T=>{var w=text("きく");append(T,w)},F=T=>{var w=text("Listen");append(T,w)};if_block(I,T=>{get(ja)&&$$props.kanji?T(U):get(ja)?T(P,1):T(F,!1)})}reset(n),delegated("click",n,onListenClicked),append(r,n)};if_block(x,r=>{$$props.speechMode=="by-number"?r(C):r(V,!1)})}append(p,g)};if_block(a,p=>{$$props.selectedVoice&&p(_)})}var c=sibling(a,2),s=child(c);{var f=p=>{var g=root_17$1(),x=sibling(first_child(g));{var C=r=>{var n=text("隠す");append(r,n)},V=r=>{var n=text("見せる");append(r,n)};if_block(x,r=>{showAnswer()?r(C):r(V,!1)})}append(p,g)},k=p=>{var g=root_20(),x=sibling(first_child(g));{var C=r=>{var n=text("かくす");append(r,n)},V=r=>{var n=text("みせる");append(r,n)};if_block(x,r=>{showAnswer()?r(C):r(V,!1)})}append(p,g)},d=p=>{var g=root_23(),x=first_child(g);{var C=r=>{var n=text("Hide");append(r,n)},V=r=>{var n=text("Show");append(r,n)};if_block(x,r=>{showAnswer()?r(C):r(V,!1)})}next(),append(p,g)};if_block(s,p=>{get(ja)&&$$props.kanji?p(f):get(ja)?p(k,1):p(d,!1)})}reset(c);var v=sibling(c,2);{var u=p=>{var g=root_26$1(),x=child(g,!0);reset(g),template_effect(C=>set_text(x,C),[getProblemWithAnswer]),append(p,g)};if_block(v,p=>{showAnswer()&&p(u)})}delegated("click",c,()=>{showAnswer(!showAnswer())}),append(e,t)};if_block(node,e=>{$$props.viewMode=="edit"?e(consequent):e(alternate_9,!1)})}var node_12=sibling(node,2);{var consequent_16=e=>{var t=root_27$1(),a=child(t);reset(t),template_effect(_=>set_text(a,`Speech tokens: ${_??""}`),[()=>JSON.stringify(get(speechTokens))]),append(e,t)};if_block(node_12,e=>{$$props.debug&&e(consequent_16)})}reset(div),append($$anchor,div),pop()}delegate(["input","keyup","click"]);var root_11=from_html('<p>問題を一個ずつ記入してください。半角の数字、「+」、「-」、「*」、「/」は大丈夫です。例えば：<span class="mono svelte-1uha8ag">123+45-67</span>。()を使えません。計算は簡単の「左から右順」です。</p>'),root_12=from_html('<p>もんだいをいっこずつきにゅうしてください。はんかくのすうじ、「+」、「-」、「*」、「/」はだいじょうぶです。たとえば：<span class="mono svelte-1uha8ag">123+45-67</span>。()をつかえません。けいさんはかんたんの「ひだりからみぎじゅん」です。</p>'),root_13=from_html('<p>Input problems one-by-one, using numbers and +-*/ characters, e.g. <span class="mono svelte-1uha8ag">123+45-67</span>.  (No commas, no parenthesis.  Note that solutions are calculated in simple left-to-right order.)</p>'),root_15=from_html("<p>問題を再生して、回答して（そろばんでも、暗算でも）、そして答えを確認してください。</p>"),root_16=from_html("<p>もんだいをさいせいして、かいとうして（そろばんでも、あんざんでも）、そしてこたえをかくにんしてください。</p>"),root_17=from_html("<p>Play back the problems, solve them (soroban or anzan), then check your answers.</p>"),root_18=from_html("<tr><td></td><td><!></td></tr>"),root_19=from_html("<button><!></button> <button><!></button>",1),root_27=from_html("答えを全部<!>",1),root_30=from_html("こたえをぜんぶ<!>",1),root_33=from_html("<!> all answers",1),root_26=from_html("<button><!></button>"),root=from_html('<!><input autocomplete="off"/> <!> <hr/> <input type="radio" name="mode" id="edit" autocomplete="off"/><label for="edit"><!></label> <input type="radio" name="mode" id="practice" autocomplete="off"/><label for="practice"><!></label> <!> <table class="svelte-1uha8ag"><tbody></tbody></table> <!>',1);function _page(e,t){push(t,!0);const a=[],_=(page.url.searchParams.get("problems")||"").split(",").map(o=>new ProblemState(o));let c=state(proxy(page.url.searchParams.get("title")||"")),s=state(proxy(page.url.searchParams.get("language")||"en-US")),f=state(void 0),k=state(100),d=state(proxy(_)),v=page.url.searchParams.get("mode");v!="edit"&&v!="practice"&&(v="edit");let u=state(proxy(v));const p="all-at-once",g="by-number";let x=page.url.searchParams.get("speechMode");x!=p&&x!=g&&(x=g);let C=state(proxy(x)),V=user_derived(()=>get(C)==g),r=state(!1),n=user_derived(()=>get(s)=="ja-JP"),I=state(!0),U=proxy(page.url.searchParams.get("debug")=="true"||!1);function P(){get(d).push(new ProblemState(""))}function F(o){set(f,o,!0)}function T(){set(C,get(C)==g?p:g,!0),W("speechMode",get(C))}function w(){typeof get(s)=="string"&&W("language",get(s))}function j(o){set(k,o,!0)}function q(){W("mode",get(u))}function A(){W("problems",get(d).map(o=>o.problem).join(","))}function L(o){o==get(d).length-1&&P(),tick().then(()=>{document.querySelectorAll("input.problem-simple")[o+1].focus()})}function H(){confirm("Are you sure you wish to clear all problems?")&&(set(d,[new ProblemState("")],!0),A())}function ie(){W("title",get(c))}function W(o,l){const h=page.url;h.searchParams.set(o,l),goto(h,{keepFocus:!0})}function se(){set(r,!get(r)),get(d).forEach(o=>o.showAnswer=get(r))}var X=root();head("1uha8ag",o=>{deferred_template_effect(()=>{$document.title=(get(c)?get(c):get(n)?"そろばん：よみあげざんツール":"Soroban reader")??""})});var ne=first_child(X);{var fe=o=>{var l=text("ページのタイトル：");append(o,l)},ve=o=>{var l=text("Title for this page:");append(o,l)};if_block(ne,o=>{get(n)?o(fe):o(ve,!1)})}var ae=sibling(ne);remove_input_defaults(ae);var _e=sibling(ae,2);VoiceSelector(_e,{onLanguageChanged:w,onVoiceChanged:F,onRateChanged:j,get speakByPart(){return get(V)},onSpeechModeChanged:T,get selectedLanguage(){return get(s)},set selectedLanguage(o){set(s,o,!0)},get kanji(){return get(I)},set kanji(o){set(I,o,!0)}});var m=sibling(_e,4);remove_input_defaults(m),m.value=m.__value="edit";var S=sibling(m),z=child(S);{var G=o=>{var l=text("編集モード");append(o,l)},Q=o=>{var l=text("へんしゅうモード");append(o,l)},Z=o=>{var l=text("Edit mode");append(o,l)};if_block(z,o=>{get(n)&&get(I)?o(G):get(n)?o(Q,1):o(Z,!1)})}reset(S);var R=sibling(S,2);remove_input_defaults(R),R.value=R.__value="practice";var M=sibling(R),K=child(M);{var de=o=>{var l=text("練習モード");append(o,l)},ue=o=>{var l=text("れんしゅうモード");append(o,l)},pe=o=>{var l=text("Practice mode");append(o,l)};if_block(K,o=>{get(n)&&get(I)?o(de):get(n)?o(ue,1):o(pe,!1)})}reset(M);var ce=sibling(M,2);{var $=o=>{var l=comment(),h=first_child(l);{var O=b=>{var y=root_11();append(b,y)},B=b=>{var y=root_12();append(b,y)},D=b=>{var y=root_13();append(b,y)};if_block(h,b=>{get(n)&&get(I)?b(O):get(n)?b(B,1):b(D,!1)})}append(o,l)},ge=o=>{var l=comment(),h=first_child(l);{var O=b=>{var y=root_15();append(b,y)},B=b=>{var y=root_16();append(b,y)},D=b=>{var y=root_17();append(b,y)};if_block(h,b=>{get(n)&&get(I)?b(O):get(n)?b(B,1):b(D,!1)})}append(o,l)};if_block(ce,o=>{get(u)=="edit"?o($):o(ge,!1)})}var oe=sibling(ce,2),le=child(oe);each(le,21,()=>get(d),index,(o,l,h)=>{var O=root_18(),B=child(O);B.textContent=`${h+1}.`;var D=sibling(B),b=child(D);ProblemSimple(b,{get selectedLanguage(){return get(s)},get kanji(){return get(I)},get selectedVoice(){return get(f)},get selectedRate(){return get(k)},get viewMode(){return get(u)},get speechMode(){return get(C)},get debug(){return U},onProblemChange:A,onEnter:()=>{L(h)},get problem(){return get(d)[h].problem},set problem(y){get(d)[h].problem=y},get showAnswer(){return get(d)[h].showAnswer},set showAnswer(y){get(d)[h].showAnswer=y}}),reset(D),reset(O),append(o,O)}),reset(le),reset(oe);var he=sibling(oe,2);{var me=o=>{var l=root_19(),h=first_child(l),O=child(h);{var B=E=>{var Y=text("問題を追加する");append(E,Y)},D=E=>{var Y=text("もんだいをついかする");append(E,Y)},b=E=>{var Y=text("Add problem");append(E,Y)};if_block(O,E=>{get(n)&&get(I)?E(B):get(n)?E(D,1):E(b,!1)})}reset(h);var y=sibling(h,2),J=child(y);{var ee=E=>{var Y=text("問題を全部消す");append(E,Y)},te=E=>{var Y=text("もんだいをぜんぶけす");append(E,Y)},N=E=>{var Y=text("Clear all problems");append(E,Y)};if_block(J,E=>{get(n)&&get(I)?E(ee):get(n)?E(te,1):E(N,!1)})}reset(y),delegated("click",h,P),delegated("click",y,H),append(o,l)},re=o=>{var l=root_26(),h=child(l);{var O=b=>{var y=root_27(),J=sibling(first_child(y));{var ee=N=>{var E=text("隠す");append(N,E)},te=N=>{var E=text("見せる");append(N,E)};if_block(J,N=>{get(r)?N(ee):N(te,!1)})}append(b,y)},B=b=>{var y=root_30(),J=sibling(first_child(y));{var ee=N=>{var E=text("かくす");append(N,E)},te=N=>{var E=text("みせる");append(N,E)};if_block(J,N=>{get(r)?N(ee):N(te,!1)})}append(b,y)},D=b=>{var y=root_33(),J=first_child(y);{var ee=N=>{var E=text("Hide");append(N,E)},te=N=>{var E=text("Show");append(N,E)};if_block(J,N=>{get(r)?N(ee):N(te,!1)})}next(),append(b,y)};if_block(h,b=>{get(n)&&get(I)?b(O):get(n)?b(B,1):b(D,!1)})}reset(l),delegated("click",l,se),append(o,l)};if_block(he,o=>{get(u)=="edit"?o(me):o(re,!1)})}delegated("input",ae,ie),bind_value(ae,()=>get(c),o=>set(c,o)),delegated("change",m,q),bind_group(a,[],m,()=>get(u),o=>set(u,o)),delegated("change",R,q),bind_group(a,[],R,()=>get(u),o=>set(u,o)),append(e,X),pop()}delegate(["input","change","click"]);export{_page as component};
